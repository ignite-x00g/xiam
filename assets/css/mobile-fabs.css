/* assets/css/mobile-fabs.css */

/* ===== FAB Stack ===== */
@media (max-width: 768px) {
  .fab-stack {
    /* position: fixed; */ /* Changed from fixed to absolute */
    position: absolute;
    /* bottom: var(--fab-stack-inset-bottom); */ /* Will be set to 15px */
    bottom: 15px; /* Relative to positioned ancestor (body or a wrapper) */
    /* right: var(--fab-stack-inset-right); */ /* Will be set to 5px */
    right: 5px;
    display: flex;
    flex-direction: column;
    gap: var(--fab-stack-gap);
    z-index: 5000; /* Keep high z-index */
  }
}
.fab-btn {
  width: var(--fab-size); /* Corrected to --fab-size */
  height: var(--fab-size); /* Corrected to --fab-size */
  border: none;
  border-radius: 50%;
  background: var(--clr-primary);
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.38rem;
  cursor: pointer;
  box-shadow: 0 4px 16px #0007;
  position: relative;
  transition: background .18s;
}
.fab-btn:hover, .fab-btn:focus {
  background: var(--clr-accent-dark);
  outline: none;
}
.fab-btn[title]:after {
  content: attr(title);
  position: absolute;
  right: 70px;
  background: var(--tooltip-bg, #333);
  color: var(--tooltip-tx, #fff);
  padding: 4px 10px;
  border-radius: 8px;
  font-size: .77rem;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity .2s;
}
.fab-btn:hover:after,
.fab-btn:focus:after {
  opacity: 1;
}

/* ===== Mobile Nav Bar ===== */
@media (max-width: 768px) {
  .mobile-nav {
    /* position: fixed; */ /* Changed to absolute to align with scrolling FABs */
    position: absolute;
    /* bottom: var(--mobile-nav-inset-bottom); */ /* Now 15px, same as FABs */
    bottom: 15px; /* Aligns with the bottom of the FAB stack */
    /* right: calc(var(--fab-size) + var(--mobile-nav-base-offset)); */ /* Old positioning */
    /* New positioning: right edge aligns with FAB stack's right edge (5px from screen) */
    right: 5px;
    width: 0; /* Initial width, expands to 85vw when active */
    display: flex;
    gap: 13px;
    padding: .55rem 1.2rem;
    background: var(--clr-bg);
    border-radius: 30px;
    box-shadow: 0 4px 14px #0003;
    /* z-index: 3000; */ /* Old z-index */
    z-index: 4100; /* New z-index: Above modals (4000), below FABs (5000) */
    transform: scaleX(0); /* Still use transform for animation */
    transform-origin: right; /* Expand from the right */
    transition: transform .3s, width .3s; /* Added width to transition */
    overflow: hidden; /* Hide content when scaled to 0 */
  }
  .mobile-nav.active {
    width: 85vw; /* Expand to 85% of mobile screen width */
    transform: scaleX(1);
  }
  .mobile-nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-size: .8rem;
    background: none;
    border: none;
    color: var(--clr-tx);
    cursor: pointer;
    transition: color .16s;
    outline: none;
  }
  .mobile-nav-item i {
    width: var(--fab-size);
    height: var(--fab-size);
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    background: var(--clr-primary);
    color: #fff;
    font-size: 1.2rem;
    margin-bottom: 4px;
  }
  .mobile-services-menu {
    position: fixed;
    bottom: 100px;
    right: 7px; /* Keep menu slightly offset from FABs */
    background: var(--clr-bg);
    border: 1px solid var(--menu-border-color, #ccc);
    border-radius: 13px;
    padding: 1.15rem 1.2rem;
    max-height: 52%;
    overflow-y: auto;
    display: none;
    z-index: 2100;
    box-shadow: 0 2px 18px #0002;
  }
  .mobile-services-menu.active {
    display: block;
  }
  .mobile-services-menu a {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 13px;
    color: var(--clr-tx);
    text-decoration: none;
    font-size: 1rem;
    font-weight: 500;
  }
}
@media (min-width: 769px) {
  .fab-stack {
    display: none;
  }
  .mobile-nav,
  .mobile-services-menu,
  .fab-stack { /* Added .fab-stack here */
    display: none !important;
  }
}

/* ===== Dark Theme Overrides for FABS and Mobile Nav ===== */
body.dark .fab-btn[title]:after {
  --tooltip-bg: #f0f0f0;
  --tooltip-tx: #333;
}

body.dark .mobile-services-menu {
  --menu-border-color: #555;
}
