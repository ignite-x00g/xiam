const qs=(s,c=document)=>c.querySelector(s),qsa=(s,c=document)=>[...c.querySelectorAll(s)];/* modals */qsa("[data-modal]").forEach(b=>b.onclick=()=>qs("#"+b.dataset.modal).classList.add("active"));qsa("[data-close]").forEach(b=>b.onclick=()=>b.closest(".modal-overlay").classList.remove("active"));addEventListener("click",e=>qsa(".modal-overlay.active").forEach(m=>{if(e.target===m)m.classList.remove("active")}));addEventListener("keydown",e=>{if(e.key==="Escape")qsa(".modal-overlay.active").forEach(m=>m.classList.remove("active"))});/* nav */qs("#menuToggle").onclick=()=>qs("#mobileNav").classList.toggle("active");qs("#mobile-services-toggle").onclick=()=>qs("#mobile-services-menu").classList.toggle("active");qs("#mobile-language-toggle").onclick=()=>{const b=qs("#mobile-language-toggle"),en=b.textContent==="EN";document.documentElement.lang=en?"es":"en";qsa("[data-en]").forEach(el=>el.textContent=en?el.dataset.es:el.dataset.en);b.textContent=en?"ES":"EN"};qs("#mobile-theme-toggle").onclick=()=>{const b=qs("#mobile-theme-toggle"),l=b.textContent==="Light";document.body.classList.toggle("dark",l);b.textContent=l?"Dark":"Light"};/* dynamic sections */qsa('#joinModal .form-section').forEach(s=>{const i=qs(".inputs",s),a=qs(".add",s),r=qs(".remove",s),ac=qs(".accept-btn",s),ed=qs(".edit-btn",s);if(!a)return;a.onclick=()=>{const ip=document.createElement("input");ip.placeholder="Enter "+qs("h2",s).textContent;i.appendChild(ip);ip.focus()};r.onclick=()=>i.lastChild&&i.removeChild(i.lastChild);ac.onclick=()=>{if(!i.children.length)return alert("Add at least one entry.");i.querySelectorAll("input").forEach(x=>x.disabled=!0);s.classList.add("completed");ac.classList.add("hidden");ed.classList.remove("hidden")};ed.onclick=()=>{i.querySelectorAll("input").forEach(x=>x.disabled=!1);s.classList.remove("completed");ac.classList.remove("hidden");ed.classList.add("hidden")}});/* stubs */qs("#joinForm").onsubmit=e=>{e.preventDefault();alert("Join form submitted");qs("#joinModal").classList.remove("active")};qs("#contactForm").onsubmit=e=>{e.preventDefault();alert("Contact form submitted");qs("#contactModal").classList.remove("active")};/* chatbot */const log=qs("#chat-log"),inp=qs("#chatbot-input"),frm=qs("#chatbot-input-row"),snd=qs("#chatbot-send"),chk=qs("#human-check");chk.onchange=()=>snd.disabled=!chk.checked;function add(t,c){const d=document.createElement("div");d.className="chat-msg "+c;d.textContent=t;log.appendChild(d);log.scrollTop=log.scrollHeight}frm.onsubmit=async e=>{e.preventDefault();if(!chk.checked)return;const m=inp.value.trim();if(!m)return;add(m,"user");inp.value="";snd.disabled=!0;add("â€¦","bot");try{const r=await fetch("https://your-cloudflare-worker.example.com/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:m})}),d=await r.json();log.lastChild.textContent=d.reply||"No reply."}catch{log.lastChild.textContent="Error: Can't reach AI."}snd.disabled=!1};
